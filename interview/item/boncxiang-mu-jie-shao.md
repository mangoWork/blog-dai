## 根据现有的数据生成词库

### 1. 提取现有的标签数据

##### 原有数据展现

&nbsp;　现有的标签数据的格式如下所示（还包括了运动健身、美食、旅游景点等）：

```
0303101 购物 商铺 服装鞋帽皮具店
0303102    购物 商铺 化妆品店
0303103    购物 商铺 文化用品店
0303104    购物 商铺 专卖店
0304000    购物 超市 
0305000    购物 便利店    
0306000    购物 家居建材   
0307000    购物 家电数码   
0308000    购物 商业街    
0401000    生活服务   通讯营业厅  
0401101    生活服务   通讯营业厅  中国联通营业厅
0401102    生活服务   通讯营业厅  中国电信营业厅
0401103    生活服务   通讯营业厅  中国移动营业厅
0402000    生活服务   售票处    
0402101    生活服务   售票处    飞机票代售点
0402102    生活服务   售票处    火车票代售点
0402103    生活服务   售票处    长途汽车票代售点
0402104    生活服务   售票处    船票代售点
.......
```

##### 实现方式

1. 利用线程安全的单例模式来读取标签文件；读取标签文件中的数据并且存放在Map中，key存放的数据为一级分类\(如：生活服务\)，value为二级分类和三级分类

### 2. 对每个分类提取1000条数据【数据中包含了信息的分类】

1. 读取文件，将文件中的POI数据转换为List
2. 遍历POI数据；找出POI数据对应的一级分类\(部分数据分类信息不全，有些可能存在二级分类不存在一级分类\)，如果没有对应的一级分类，则舍弃该数据，如果存在一级分类，将数据存放在Map中，key为一级分类，value为该一级分类的集合；遍历直到每个分类中的数据都满足1000条数据的时候，则停止遍历。

### 3.  对数据进行分词

1. 在搜狗词库中下载对应的商铺词库作为IK分词的扩展次
2. 利用IK分词对其中的单词进行分词\(配置好对应的停止词，扩展词语\)，统计所有词的词频，筛选出词频大于4并且词的长度大于2的单词，\(按照分类进行存储的，每个分类中的词频以及单词的长度\)

### 4. 计算信息增益

### 5. 根据信息增益对结果进行排序

&nbsp;　输出信息增益较小的数据

## AOI和POI爬虫数据去重

### 项目需求

&nbsp;　将从高德和百度中爬取得数据进行去重，同一个地方在高德中爬取出来的数据可能跟百度中的数据名称是不一致，这时候就需要将同一个地方的百度中的数据和高德中的数据进行合并。

### 合并的步骤

#### 1. 将AOI以及POI的数据存放在Solr中

&nbsp;　读取AOI以及POI的高德数据，并为每条数据标记数据类型\(高德\)

&nbsp;　向Solr中提交数据(提交数据的过程中不是每条数据提交一次，而是多条数据提交一次)

#### 2. POI数据的合并

##### 2.1 读取POI的百度文件数据并且查询出Solr中相似的数据

&nbsp;　读取POI的百度数据(用于查询出来对应solr中相似的数据)

&nbsp;　当读取出文件中的一条数据的时候，利用多线程的Mater-worker模式，向任务队列中提交任务，多线程执行任务，向Solr中查询出来相似的数据(查询的时候会把POI中的数据限制在一定的范围之内,如距离相差500以内的结果；Solr中也会使用对应的扩展词、以及分词生成的停止词等)

##### 2.2 计算该数据与查询出来的数据的相似度

&nbsp;　利用IK分词，将数据中的name、adress、tag进行分词，并且利用余旋相似度计算出来对应的相似度，根据配置中的name、address、tag所占的权重来获取该数据总的相似度

&nbsp;　获取查询出来的满足name、address、tag的最小相似度的数据以及满足根据权重计算出来的总的相似度。在筛选出来的数据中获取到总的相似度最高的一条数据。

##### 2.3 数据的合并

&nbsp;　将数据进行合并，根据高德数据进行合并，合并的数据后面标记百度数据对应的ID以及对应的相似度(利用**余旋相似度**来判断)。

#### 3. AOI数据的合并

##### 3.1 读取AOI的百度文件数据并且查询出Solr中相似的数据

&nbsp;　读取AOI的百度数据(用于查询出来对应solr中相似的数据)

&nbsp;　当读取出文件中的一条数据的时候，利用多线程的Mater-worker模式，向任务队列中提交任务，多线程执行任务，向Solr中查询出来相似的数据

##### 3.2 筛选出AOI区域相交，覆盖的数据

&nbsp;　查询出来的数据与文件中的数据中的经纬度画出对应的矩形，筛选出对应两条数据相交或者覆盖的数据(利用**射线法**来判断)

##### 3.3 计算合并对应的相似度

&nbsp;　利用IK分词，将数据中的name、adress、tag进行分词，并且利用余旋相似度计算出来对应的相似度，根据配置中的name、address、tag所占的权重来获取该数据总的相似度

&nbsp;　获取查询出来的满足name、address、tag的最小相似度的数据以及满足根据权重计算出来的总的相似度。在筛选出来的数据中获取到总的相似度最高的一条数据。

##### 3.3 数据的合并

&nbsp;　将数据进行合并，根据高德数据进行合并，合并的数据后面标记百度数据对应的ID以及对应的相似度。


#### 数据样例

##### AOI数据

```

2304	131	131	15	汉庭酒店(北京昌平科技园店)	昌平区，水屯村南2号楼	be07953e9b88e725c8213d81	116.2345,40.206615;116.23488,40.20602;116.23464,40.205715;116.23391,40.205723;116.23402,40.20654;116.23437,40.206524;116.2345,40.206615	116.22179677936806,40.19965884151308;116.22217944867366,40.19906177317564;116.22193870369266,40.198758552311105;116.2212051493422,40.19877130519359;116.22131454668707,40.19958703423394;116.22166627248758,40.1995687551036;116.22179677936806,40.19965884151308	连锁快捷酒店	112
1960	131	131	15	永定路127号院	北京市海淀区永定路五一小学院内	1f822a1681863598f11937f9	116.270485,39.922398;116.27088,39.9224;116.27089,39.92211;116.270485,39.922096;116.270485,39.922398	116.25804342576066,39.914953850860734;116.25843955518683,39.91495165910012;116.25844950175477,39.91466146521208;116.25804333906855,39.914651760919654;116.25804342576066,39.914953850860734	住宅区	E30100
1552	131	131	15	六合庄村	大兴靶场六合庄	b9d92fd8cabac22c3517dcd9	116.25538,39.708435;116.255356,39.70886;116.25535,39.709522;116.2554,39.71017;116.25544,39.71077;116.25556,39.711273;116.25569,39.71175;116.25661,39.71179;116.25669,39.70969;116.25584,39.70967;116.25585,39.709217;116.2559,39.708744;116.255974,39.70849;116.25538,39.708435	116.24287691515691,39.70125606683437;116.2428527917025,39.70168145410655;116.24284680805832,39.702343510776146;116.24289695803398,39.702990498736256;116.24293643123293,39.70358942437119;116.24305655933486,39.70409002018465;116.2431867818439,39.704564459693835;116.24411278620819,39.70458843817538;116.24419576164071,39.70248817242264;116.24334008934102,39.70248297029747;116.2433501140222,39.70202982769332;116.24340040296521,39.70155598991612;116.24347487149564,39.701300718844;116.24287691515691,39.70125606683437	村庄	35
1959	131	131	15	公平大厦	北京市顺义区顺密路	5c2dc21d1efc15046ec02c8b	116.788216,40.25247;116.78893,40.25247;116.788895,40.25188;116.78817,40.25182;116.788216,40.25247	116.7756234980186,40.24507861515042;116.77633409180731,40.245089390963585;116.7762989313411,40.24449885164779;116.77557736575501,40.24442791862749;116.7756234980186,40.24507861515042	写字楼	E30101
2305	131	131	15	保利欣苑	北京市丰台区望园路9号	dbf4d6ee4084482a6fa3cc00	116.288376,39.88058;116.288704,39.880714;116.28942,39.881054;116.29011,39.881313;116.29161,39.878914;116.29132,39.878803;116.29055,39.87854;116.2903,39.878475;116.290054,39.87841;116.28995,39.87844;116.28947,39.879173;116.28911,39.879585;116.28882,39.879932;116.28863,39.880234;116.288376,39.88058	116.27593216448385,39.873009462943266;116.27625990857561,39.87314276097284;116.27697534761808,39.87348124473956;116.2776644286289,39.87373973821222;116.27915844042715,39.87135005958766;116.27886971788861,39.87123712399599;116.27810310413173,39.87096898287317;116.27785419754741,39.87090231565942;116.27760927450821,39.87083567405892;116.2775055268174,39.870865436457876;116.27702558956362,39.871599679630734;116.27666571620232,39.872012579023206;116.27637583046234,39.87236030477348;116.27618596121108,39.87266280562803;116.27593216448385,39.873009462943266	住宅区	E30100
1552	131	131	15	泰豪智能大厦	北京市大兴区锦绣街3号	a6cd858f71a4fadeb9df8fa2	116.522964,39.793613;116.52294,39.793674;116.52295,39.79373;116.523735,39.794094;116.52385,39.794106;116.52482,39.79291;116.52392,39.79243;116.522964,39.793613	116.51062268398587,39.78610017470656;116.51059866679753,39.78616114228065;116.51060878475826,39.78621716788885;116.5113975485478,39.786582591841466;116.51151304340704,39.786594794710645;116.51248551213662,39.785400227917506;116.5115810960633,39.78491860818518;116.51062268398587,39.78610017470656	写字楼	E30101

```

##### POI数据

```
	B000A00076	碧云寺路31号附近	110108						香山工业公司停车场		116.198922	39.994942																					车位：空位约15个，总共有79个								010-62591272	110108	010		116.198922	39.994942		116.19279134136494	39.99366836109272		150905
	B000A0007A	玉泉山路北100米	110108						天下第一泉饮料厂		116.251826	39.995994													116.251397，39.996723_116.252698，39.996883_116.252894，39.996077_116.252438，39.99602_116.251807，39.995942_116.251675，39.996191_116.251397，39.996723																	110108	010	116.251397,39.996723;116.252698,39.996883;116.252894,39.996077;116.252438,39.99602;116.251807,39.995942;116.251675,39.996191;116.251397,39.996723	116.251826	39.995994	116.2453539513271,39.99550292526741;116.2466553701654,39.99566293384404;116.24685154589355,39.99485697898776;116.2463953992179,39.99479997596988;116.24576419613412,39.99472197173106;116.24563211765032,39.99497095688694;116.2453539513271,39.99550292526741	116.24578319551209	39.99477396924598		170300
	B000A0007B	玉泉山路西50米	110108						第二皮鞋厂		116.252179	39.995763													116.251807，39.995942_116.252438，39.99602_116.252526，39.995581_116.251953，39.9955_116.251942，39.995522_116.251807，39.995942																	110108	010	116.251807,39.995942;116.252438,39.99602;116.252526,39.995581;116.251953,39.9955;116.251942,39.995522;116.251807,39.995942	116.252179	39.995763	116.24576419613412,39.99472197173106;116.2463953992179,39.99479997596988;116.24648348858082,39.994361000296564;116.24591030554558,39.99427999693576;116.24589929883572,39.99430199563091;116.24576419613412,39.99472197173106	116.24613634638709	39.99454298608802		170300
	B000A0007D	槐树居路与玉泉山路交叉口西150米	110108						青龙桥木器厂		116.252652	39.995836													116.252438，39.99602_116.252894，39.996077_116.252968，39.995736_116.252526，39.995581_116.252438，39.99602																	110108	010	116.252438,39.99602;116.252894,39.996077;116.252968,39.995736;116.252526,39.995581;116.252438,39.99602	116.252652	39.995836	116.2463953992179,39.99479997596988;116.24685154589355,39.99485697898776;116.24692561721793,39.9945159979871;116.24648348858082,39.994361000296564;116.2463953992179,39.99479997596988	116.24660949664738	39.99461598851247		170300

```
